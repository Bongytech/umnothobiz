# Add to .github/workflows/secrets.yml or create new file
name: ðŸ”’ Scheduled Security Scans

on:
  schedule:
    # Daily at 2 AM UTC
    - cron: '0 2 * * *'
    # Weekly deep scan Sunday at 3 AM UTC
    - cron: '0 3 * * 0'
  workflow_dispatch:

jobs:
  daily-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Dependency Scan
        run: |
          # Frontend
          cd ${{ github.workspace }}
          npx snyk test --json > snyk-frontend-$(date +%Y%m%d).json
          
          # Functions
          cd functions
          npx snyk test --json > ../snyk-functions-$(date +%Y%m%d).json
          
      - name: OWASP Dependency Check
        uses: dependency-check/Dependency-Check_Action@main
        with:
          project: 'umnotho-daily'
          path: '.'
          format: 'HTML'
          
      - name: Upload Reports
        uses: actions/upload-artifact@v4
        with:
          name: security-reports-${{ github.sha }}
          path: |
            snyk-*.json
            dependency-check-report.html