title = "Unmotho Firebase Security Configuration"
version = "2.0.0"

# Global settings
[allowlist]
description = "Allowlisted items"
paths = [
  "test/",
  "*.test.ts",
  "*.spec.ts",
  "__mocks__/",
  ".github/workflows/secrets-scan.yml"  # Contains example patterns
]

[[rules]]
id = "firebase-api-key"
description = "Firebase Web API Key"
regex = '''AIza[0-9A-Za-z\\-_]{35}'''
tags = ["firebase", "api-key", "key", "critical"]
keywords = ["apiKey", "firebase"]

[[rules]]
id = "firebase-service-account"
description = "Firebase Service Account JSON"
regex = '''\\{\\s*"type"\\s*:\\s*"service_account"\\s*\\}'''
tags = ["firebase", "service-account", "json", "critical"]
keywords = ["service_account", "private_key"]

[[rules]]
id = "google-oauth-client-secret"
description = "Google OAuth Client Secret"
regex = '''["']client_secret["']\\s*[:=]\\s*["'][^"']{16,}["']'''
tags = ["google", "oauth", "secret", "critical"]

[[rules]]
id = "firebase-database-url"
description = "Firebase Database URL"
regex = '''https://[a-zA-Z0-9\\-]+\\.(firebaseio\\.com|firebasedatabase\\.app)'''
tags = ["firebase", "database", "url"]

[[rules]]
id = "firebase-project-id"
description = "Firebase Project ID Pattern"
regex = '''["']projectId["']\\s*[:=]\\s*["'][a-zA-Z0-9\\-]+["']'''
tags = ["firebase", "project-id"]

[[rules]]
id = "stripe-secret-key"
description = "Stripe Secret Key"
regex = '''(sk|rk)_(test|live)_[0-9a-zA-Z]{24,99}'''
tags = ["stripe", "payment", "secret", "critical"]

[[rules]]
id = "jwt-secret"
description = "JWT Secret or Private Key"
regex = '''-----BEGIN (RSA|EC|DSA) PRIVATE KEY-----'''
tags = ["jwt", "crypto", "private-key", "critical"]

[[rules]]
id = "generic-api-key"
description = "Generic API Key Pattern"
regex = '''[0-9a-zA-Z]{32,45}'''
secretGroup = 1
tags = ["api-key", "generic"]
entropy = 3.5

[[rules]]
id = "password-in-code"
description = "Password in source code"
regex = '''["']password["']\\s*[:=]\\s*["'][^"']{4,}["']'''
tags = ["password", "credential"]